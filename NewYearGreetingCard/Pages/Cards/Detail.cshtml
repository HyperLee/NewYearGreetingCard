@page
@model NewYearGreetingCard.Pages.Cards.DetailModel
@{
    ViewData["Title"] = Model.Card!.StyleName + " - 賀卡詳情";
}

<div class="container">
    <div class="row justify-content-center">
        <div class="col-lg-8">
            <div class="card-detail @Model.Card.CssClass">
                <div class="card-art text-center p-5">
                    <!-- T037: Distinct inline SVG per card style, image-dominant layout -->
                    <!-- T038: Coverage note — FR-010 (style variety), FR-002 (horse + CNY elements), FR-009 (art-first layout) -->
                    <svg viewBox="0 0 400 300" class="card-svg" xmlns="http://www.w3.org/2000/svg" role="img" aria-label="@Model.Card.StyleName 馬年賀卡">
                        <title>@Model.Card.StyleName 馬年賀卡</title>

                        @switch (Model.Card.Style)
                        {
                            case CardStyle.Realistic:
                                <!-- Style: Realistic (Gradient, Shadow, Detail) -->
                                <defs>
                                    <linearGradient id="realistic-body" x1="0%" y1="0%" x2="100%" y2="100%">
                                        <stop offset="0%" stop-color="#9c6239" />
                                        <stop offset="100%" stop-color="#5c3a21" />
                                    </linearGradient>
                                    <radialGradient id="realistic-highlight" cx="50%" cy="40%" r="60%">
                                        <stop offset="0%" stop-color="#f5d7a5" stop-opacity="0.9" />
                                        <stop offset="100%" stop-color="#f5d7a5" stop-opacity="0" />
                                    </radialGradient>
                                    <filter id="realistic-shadow" x="-20%" y="-20%" width="140%" height="140%">
                                        <feDropShadow dx="2" dy="4" stdDeviation="3" flood-color="#3b2412" flood-opacity="0.4" />
                                    </filter>
                                </defs>
                                <ellipse cx="200" cy="240" rx="120" ry="18" fill="rgba(0,0,0,0.2)" />
                                <g class="horse-figure" transform="translate(80, 30)">
                                    <path d="M40 160 Q20 110 60 70 Q90 40 130 55 Q170 30 200 70 Q220 100 210 140 Q200 190 160 210 L150 250 L120 250 L125 210 L90 210 L85 250 L60 250 L65 210 Q40 200 40 160 Z" fill="url(#realistic-body)" filter="url(#realistic-shadow)" />
                                    <path d="M90 70 Q80 110 95 150" stroke="#4b2e18" stroke-width="4" stroke-linecap="round" fill="none" />
                                    <circle cx="140" cy="95" r="4" fill="#2d1c0f" />
                                    <ellipse cx="120" cy="150" rx="60" ry="40" fill="url(#realistic-highlight)" />
                                </g>
                                <g class="cny-element" transform="translate(285, 30)">
                                    <rect x="10" y="0" width="40" height="60" rx="6" fill="#c8102e" />
                                    <circle cx="30" cy="22" r="14" fill="#d4af37" />
                                    <text x="30" y="29" text-anchor="middle" fill="#7a1b1b" font-size="18" font-family="serif">福</text>
                                    <line x1="30" y1="60" x2="30" y2="85" stroke="#d4af37" stroke-width="3" />
                                    <path d="M22 85 L30 98 L38 85" fill="#d4af37" />
                                </g>
                                break;

                            case CardStyle.Cute:
                                <!-- Style: Cute (Rounded, Pastel, Simple) -->
                                <g class="horse-figure" transform="translate(70, 40)">
                                    <ellipse cx="140" cy="140" rx="85" ry="55" fill="#ffb6c1" />
                                    <circle cx="90" cy="90" r="40" fill="#ffb6c1" />
                                    <circle cx="78" cy="85" r="6" fill="#333" />
                                    <circle cx="102" cy="85" r="6" fill="#333" />
                                    <ellipse cx="90" cy="100" rx="10" ry="6" fill="#ff69b4" opacity="0.7" />
                                    <path d="M70 60 L85 30 L100 60 Z" fill="#ffb6c1" />
                                    <rect x="110" y="180" width="20" height="50" rx="8" fill="#ffb6c1" />
                                    <rect x="150" y="180" width="20" height="50" rx="8" fill="#ffb6c1" />
                                    <path d="M170 115 Q190 125 200 140" stroke="#ff6fae" stroke-width="5" stroke-linecap="round" fill="none" />
                                </g>
                                <g class="cny-element" transform="translate(30, 30)">
                                    <rect x="0" y="0" width="50" height="60" rx="8" fill="#ff6fae" />
                                    <circle cx="25" cy="22" r="14" fill="#ffd700" />
                                    <text x="25" y="29" text-anchor="middle" fill="#fff" font-size="18">春</text>
                                    <line x1="25" y1="60" x2="25" y2="80" stroke="#ffd700" stroke-width="3" />
                                </g>
                                break;

                            case CardStyle.SciFi:
                                <!-- Style: SciFi (Geometric, Lines, Neon) -->
                                <g class="horse-figure" transform="translate(60, 35)">
                                    <polyline points="60,200 110,70 190,50 240,120 200,220 110,220 60,200" fill="none" stroke="#00ffff" stroke-width="3" />
                                    <line x1="110" y1="70" x2="200" y2="220" stroke="#00ffff" stroke-width="1.5" opacity="0.6" />
                                    <line x1="60" y1="200" x2="190" y2="50" stroke="#ff00ff" stroke-width="1" opacity="0.5" />
                                    <circle cx="140" cy="110" r="6" fill="#00ffff" />
                                    <circle cx="200" cy="160" r="4" fill="#ff00ff" />
                                </g>
                                <g class="cny-element" transform="translate(285, 25)">
                                    <polygon points="30,0 60,18 60,48 30,66 0,48 0,18" fill="none" stroke="#ff00ff" stroke-width="2" />
                                    <text x="30" y="42" text-anchor="middle" fill="#00ffff" font-family="monospace" font-size="22">福</text>
                                </g>
                                break;

                            case CardStyle.InkWash:
                                <!-- Style: InkWash (Brush strokes, Organic, B&W) -->
                                <defs>
                                    <filter id="ink-blur">
                                        <feGaussianBlur in="SourceGraphic" stdDeviation="1.5" />
                                    </filter>
                                </defs>
                                <g class="horse-figure" transform="translate(90, 60)">
                                    <path d="M40 160 Q80 90 140 120 Q170 140 190 210" fill="none" stroke="#1a1a1a" stroke-width="12" stroke-linecap="round" filter="url(#ink-blur)" opacity="0.7" />
                                    <path d="M40 160 Q80 90 140 120 Q170 140 190 210" fill="none" stroke="#000" stroke-width="4" stroke-linecap="round" />
                                    <path d="M90 70 Q120 40 150 70" fill="none" stroke="#1a1a1a" stroke-width="8" stroke-linecap="round" />
                                    <path d="M110 130 L110 230" fill="none" stroke="#1a1a1a" stroke-width="6" stroke-linecap="round" />
                                </g>
                                <g class="cny-element" transform="translate(300, 60)">
                                    <rect x="0" y="0" width="60" height="60" fill="#a00" opacity="0.18" stroke="#a00" stroke-width="2" />
                                    <text x="30" y="40" text-anchor="middle" fill="#a00" font-family="serif" font-size="26">春</text>
                                </g>
                                break;

                            case CardStyle.PaperCut:
                                <!-- Style: PaperCut (Symmetric, Sharp, Red/Gold) -->
                                <g class="horse-figure" transform="translate(80, 45)">
                                    <path d="M70 180 L110 70 L160 70 L190 110 L210 160 L190 220 L160 240 L110 240 L90 210 Z" fill="#fff" />
                                    <polygon points="130,120 160,140 130,160" fill="#b22222" />
                                    <circle cx="150" cy="200" r="12" fill="#b22222" />
                                    <path d="M110 70 L95 40 L120 55 Z" fill="#fff" />
                                </g>
                                <g class="cny-element" transform="translate(20, 25)">
                                    <circle cx="30" cy="30" r="25" fill="none" stroke="#ffd700" stroke-width="3" stroke-dasharray="5,5" />
                                    <text x="30" y="40" text-anchor="middle" fill="#ffd700" font-size="22">吉</text>
                                </g>
                                break;

                            case CardStyle.Classical:
                                <!-- Style: Classical (Seal script, refined) -->
                                <g class="horse-figure" transform="translate(80, 50)">
                                    <path d="M70 60 H190 V90 H120 V130 H170 V160 H120 V230" fill="none" stroke="#5c0e0e" stroke-width="10" stroke-linecap="square" />
                                    <rect x="175" y="50" width="12" height="45" fill="#5c0e0e" />
                                    <circle cx="185" cy="210" r="6" fill="#5c0e0e" />
                                </g>
                                <g class="cny-element" transform="translate(280, 45)">
                                    <rect x="0" y="0" width="70" height="90" fill="none" stroke="#8b0000" stroke-width="3" />
                                    <rect x="8" y="8" width="54" height="74" fill="#8b0000" opacity="0.08" />
                                    <text x="35" y="55" text-anchor="middle" fill="#5c0e0e" font-family="serif" font-weight="bold" font-size="30">印</text>
                                </g>
                                break;

                            case CardStyle.Minimalist:
                                <!-- Style: Minimalist (Single line) -->
                                <g class="horse-figure" transform="translate(90, 90)">
                                    <path d="M60 120 Q110 40 170 110 Q190 150 150 160" fill="none" stroke="#333" stroke-width="2" />
                                    <line x1="120" y1="110" x2="120" y2="200" stroke="#333" stroke-width="2" />
                                    <circle cx="170" cy="110" r="3" fill="#333" />
                                </g>
                                <g class="cny-element" transform="translate(320, 220)">
                                    <circle cx="20" cy="20" r="18" fill="none" stroke="#c8102e" stroke-width="1.5" />
                                    <text x="20" y="26" text-anchor="middle" fill="#c8102e" font-size="12">馬</text>
                                </g>
                                break;

                            case CardStyle.FolkArt:
                                <!-- Style: FolkArt (Bold, Colorful, Patterned) -->
                                <g class="horse-figure" transform="translate(50, 35)">
                                    <path d="M70 190 Q70 70 130 70 L200 70 Q260 70 260 190 L260 230 L230 230 L230 190 L100 190 L100 230 L70 230 Z" fill="#e60000" />
                                    <circle cx="165" cy="125" r="35" fill="#ffcc00" />
                                    <text x="165" y="135" text-anchor="middle" fill="#e60000" font-size="26">春</text>
                                    <circle cx="110" cy="160" r="8" fill="#00cc00" />
                                    <circle cx="220" cy="160" r="8" fill="#00cc00" />
                                </g>
                                <g class="cny-element" transform="translate(280, 30)">
                                    <rect x="0" y="0" width="18" height="60" fill="#ffcc00" />
                                    <rect x="24" y="10" width="18" height="60" fill="#ffcc00" />
                                    <rect x="48" y="20" width="18" height="60" fill="#ffcc00" />
                                </g>
                                break;

                            case CardStyle.Illustration:
                                <!-- Style: Illustration (Hand-drawn feel) -->
                                <g class="horse-figure" transform="translate(70, 60)">
                                    <path d="M60 170 C70 120, 120 60, 180 90 S240 140, 220 200" fill="none" stroke="#d2691e" stroke-width="3" stroke-linecap="round" stroke-dasharray="12,6" />
                                    <circle cx="140" cy="100" r="6" fill="#f4a460" />
                                    <path d="M180 90 L200 60" stroke="#d2691e" stroke-width="3" stroke-linecap="round" />
                                    <path d="M80 200 Q140 230 200 210" fill="none" stroke="#ff7f50" stroke-width="3" />
                                </g>
                                <g class="cny-element" transform="translate(270, 210)">
                                    <rect x="0" y="0" width="50" height="60" rx="8" fill="#ff7f50" opacity="0.25" />
                                    <text x="25" y="38" text-anchor="middle" fill="#d2691e" font-size="16">新年</text>
                                    <line x1="25" y1="60" x2="25" y2="80" stroke="#d2691e" stroke-width="2" />
                                </g>
                                break;

                            case CardStyle.PopArt:
                                <!-- Style: PopArt (Dots, High Contrast) -->
                                <defs>
                                    <pattern id="pop-dots" x="0" y="0" width="12" height="12" patternUnits="userSpaceOnUse">
                                        <circle cx="6" cy="6" r="3" fill="#000" opacity="0.2" />
                                    </pattern>
                                </defs>
                                <rect x="60" y="30" width="280" height="220" fill="url(#pop-dots)" />
                                <g class="horse-figure" transform="translate(120, 70)">
                                    <rect x="0" y="0" width="160" height="150" fill="#ff0099" stroke="#000" stroke-width="5" />
                                    <text x="80" y="95" text-anchor="middle" fill="#ffff00" font-weight="bold" font-size="70" stroke="#000" stroke-width="3">馬</text>
                                </g>
                                <g class="cny-element" transform="translate(20, 20)">
                                    <polygon points="50,0 60,30 90,30 65,50 75,80 50,60 25,80 35,50 10,30 40,30" fill="#ffff00" stroke="#000" stroke-width="2" />
                                    <text x="50" y="100" text-anchor="middle" fill="#000" font-size="14">WOW!</text>
                                </g>
                                break;
                        }
                    </svg>
                </div>
                <div class="card-info p-3 text-center">
                    <h1 class="cny-title mb-2">@Model.Card.StyleName</h1>
                    <p class="card-description text-muted mb-0">@Model.Card.Description</p>
                </div>
            </div>

            <partial name="_GreetingMessages" model="Model.Card!.Messages" />

            <div class="card-navigation-buttons d-flex justify-content-between align-items-center mt-4">
                <a asp-page="/Cards/Detail" asp-route-id="@Model.PreviousCardId" class="btn btn-outline-primary card-nav-prev">
                    ← 上一張
                </a>
                <a asp-page="/Cards/Index" class="btn btn-outline-secondary">返回賀卡總覽</a>
                <a asp-page="/Cards/Detail" asp-route-id="@Model.NextCardId" class="btn btn-outline-primary card-nav-next">
                    下一張 →
                </a>
            </div>
        </div>
    </div>
</div>
